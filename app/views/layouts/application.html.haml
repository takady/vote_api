!!!
%html
  %head
    %meta{:content => 'text/html; charset=UTF-8', 'http-equiv' => 'Content-Type'}/
    %meta{:name => 'viewport', :content => 'width=device-width, initial-scale=1'}/
    %title= @title.present? ? "#{@title} | VoteRace" : 'VoteRace'
    = stylesheet_link_tag    'application', media: 'all'
    = javascript_include_tag 'application'
    = csrf_meta_tags
    = favicon_link_tag
    = analytics_init if GoogleAnalytics.valid_tracker?
  %body
    %nav.navbar.navbar-default.navbar-fixed-top
      .container
        .navbar-header
          - if signed_in?
            .navbar-toggle
              - if current_page?(user_path(current_user.username))
                = link_to logout_path do
                  = fa_icon 'sign-out', text: 'Logout'
              - else
                = link_to image_tag(current_user.image_url, class: 'avatar'), user_path(current_user.username)
                = link_to new_race_path, class: 'btn btn-primary new-race' do
                  = fa_icon :plus, text: 'New Race'
          - else
            .navbar-toggle.collapsed{:type => 'button', :'data-toggle' => 'collapse', :'data-target' => '#navbar', :'aria-expanded' => 'false', :'aria-controls' => 'navbar'}
              %span.sr-only
              %span.icon-bar
              %span.icon-bar
              %span.icon-bar
          = link_to image_tag('voterace.jpg'), root_path, class: 'navbar-brand'
        #navbar.collapse.navbar-collapse
          %ul.nav.navbar-nav.navbar-right
            - if signed_in?
              %li.dropdown
                = link_to '#', class: 'dropdown-toggle', 'data-toggle': 'dropdown' do
                  = image_tag(current_user.image_url, class: 'avatar')
                  .caret
                %ul.dropdown-menu
                  %li= link_to 'Your profile', user_path(current_user.username)
                  %li= link_to 'Settings', settings_path
                  %li.divider{role: 'separator'}
                  %li
                    = link_to logout_path do
                      = fa_icon 'sign-out', text: 'Logout'
              %li
                = link_to new_race_path, class: 'btn', id: 'new-race-button' do
                  = fa_icon :plus, text: 'New Race'
            - else
              %li
                = link_to signin_path, class: 'btn', id: 'sign-in-button' do
                  = fa_icon 'sign-in', text: 'Sign in'
              %li
                = link_to signup_path, class: 'btn', id: 'sign-up-button' do
                  = fa_icon 'sign-in', text: 'Sign up'

    - if current_page?(root_path) && !signed_in?
      %header.jumbotron
        .container
          .row
            .col-md-5.col-md-offset-1
              %h1.title VoteRace
              %p.copy Which one would you vote for ?
            .col-md-3.col-md-offset-1
              %h2.title Sign in
              = form_tag signin_path, method: :post do
                .form-group
                  = text_field_tag :identifier, @identifier, class: 'form-control', placeholder: 'Username or Email'
                .form-group
                  = password_field_tag :password, '', class: 'form-control', placeholder: 'Password'
                .form-group
                  = submit_tag 'Sign in', class: 'btn btn-success'

    .container.main-content
      - if flash[:notice]
        .row
          .col-md-12
            .alert.alert-success
              = flash[:notice]
      - if flash[:alert]
        .row
          .col-md-12
            .alert.alert-danger
              = flash[:alert]
      = yield
    %footer.container-fluid
      .container
        .row
          .col-md-12
            %p.copyright.text-center= "Â© #{Time.zone.now.year} VoteRace."
